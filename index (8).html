<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Sales Dashboard</title>
<style>*{margin:0;padding:0;box-sizing:border-box}body{background:#060606}</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.development.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.development.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.2/babel.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
<script>window.React=React;</script>
<script src="https://unpkg.com/recharts@2.8.0/umd/Recharts.js"></script>
</head>
<body>
<div id="root"></div>
<script type="text/babel">
const { useState, useMemo, useRef, useEffect } = React;
const { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer } = Recharts;

// ── CLIENT CONFIG ─────────────────────────────────────────
// To add a new client: copy a block, fill in slug/name/csvUrl/monthlyTarget
const CLIENTS = [
  {
    slug: "client",
    name: "Client",
    csvUrl: "https://docs.google.com/spreadsheets/d/e/2PACX-1vT7dUSBeMfyhjQwGP4mgQUmJhqX9k9ZvkkHZ9f8LUw_pUmO_5IdzOHauOqv5vuBzAzw_FGgNDOKJVY9/pub?gid=1221331135&single=true&output=csv",
    monthlyTarget: 100000,
  },
  // { slug: "acme", name: "Acme Corp", csvUrl: "YOUR_CSV_URL", monthlyTarget: 150000 },
];
// ─────────────────────────────────────────────────────────

const BG="#060606",CARD="#0d0d0d",BORDER="#141414",BORDER2="#1e1e1e",WHITE="#F1F5F9",LABEL="#888",SUB="#666",DIM="#333",MED="#999",ACCENT="#F97316",GREEN="#22D3A5",RED="#F43F5E";
const fmt$=v=>v.toLocaleString("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0});
const fmtN=v=>v.toLocaleString();
const TODAY=new Date();
const MONTH_NAMES=["January","February","March","April","May","June","July","August","September","October","November","December"];
const SHORT_MONTHS=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
function addDays(d,n){const r=new Date(d);r.setDate(r.getDate()+n);return r;}
function addMonths(d,n){const r=new Date(d);r.setMonth(r.getMonth()+n);return r;}
function sameDay(a,b){return a&&b&&a.toDateString()===b.toDateString();}
function monthKey(d){return"target:"+d.getFullYear()+"-"+String(d.getMonth()+1).padStart(2,"0");}
function isCurrentMonth(d){return d.getFullYear()===TODAY.getFullYear()&&d.getMonth()===TODAY.getMonth();}
function dateStr(d){if(!d)return"";return""+(SHORT_MONTHS[d.getMonth()])+" "+(d.getDate())+", "+(d.getFullYear())+"";}
function getRangeLabel(s,e){if(!s)return"Select range";if(!e||sameDay(s,e))return dateStr(s);if(s.getFullYear()===e.getFullYear()&&s.getMonth()===e.getMonth())return""+(SHORT_MONTHS[s.getMonth()])+" "+(s.getDate())+" – "+(e.getDate())+", "+(s.getFullYear())+"";if(s.getFullYear()===e.getFullYear())return""+(SHORT_MONTHS[s.getMonth()])+" "+(s.getDate())+" – "+(SHORT_MONTHS[e.getMonth()])+" "+(e.getDate())+", "+(s.getFullYear())+"";return""+(dateStr(s))+" – "+(dateStr(e))+"";}
function getPreset(label){if(label==="Today")return{start:TODAY,end:TODAY};if(label==="This Week"){const day=TODAY.getDay();const diff=day===0?6:day-1;return{start:addDays(TODAY,-diff),end:TODAY};}if(label==="This Month")return{start:new Date(TODAY.getFullYear(),TODAY.getMonth(),1),end:TODAY};if(label==="Last 7D")return{start:addDays(TODAY,-6),end:TODAY};if(label==="Last 30D")return{start:addDays(TODAY,-29),end:TODAY};if(label==="Last 90D")return{start:addDays(TODAY,-89),end:TODAY};}

function parseCSV(data) {
  if (!data || !data.length) return { chart: [], totals: {}, prev: {} };
  const rows = data.filter(r => r["Today's date"] || r["Timestamp"]);
  const sum = key => rows.reduce((a, r) => a + (parseFloat(r[key]) || 0), 0);
  const totals = {
    cash: sum("Cash Collected from Your Sets Today (Closed)") || sum("Cash ($)"),
    calls: sum("Calls Booked") || sum("Calls Booked "),
    closes: sum("Closes") || 0,
    shows: sum("Shows") || 0,
    outbounds: sum("Outbound Messages Sent") || sum("Outbounds"),
    convos: sum("Total Conversations Had") || sum("Conversations"),
    followups: sum("Follow-Up Conversations") || sum("Follow-Ups"),
    hours: sum("Hours Worked") || sum("Hours"),
    pitched: sum("Calls Pitched") || 0,
    inbounds: sum("Inbound Conversations") || sum("Inbounds Received") || 0,
    qualified: sum("Qualified Calls Booked") || sum("Qualified Calls") || 0,
  };
  totals.closeRate = ((totals.closes / (totals.shows || 1)) * 100).toFixed(1);
  totals.showRate = ((totals.shows / (totals.calls || 1)) * 100).toFixed(1);
  totals.aov = totals.closes > 0 ? Math.round(totals.cash / totals.closes) : 0;
  totals.callToBook = ((totals.calls / (totals.convos || 1)) * 100).toFixed(1);

  // Build chart by date
  const byDate = {};
  rows.forEach(r => {
    const dateRaw = r["Today's date"] || r["Timestamp"] || "";
    const d = new Date(dateRaw);
    if (isNaN(d)) return;
    const label = ""+(SHORT_MONTHS[d.getMonth()])+" "+(d.getDate())+"";
    if (!byDate[label]) byDate[label] = { label, cash: 0, calls: 0, closes: 0, shows: 0, outbounds: 0, convos: 0 };
    byDate[label].cash += parseFloat(r["Cash Collected from Your Sets Today (Closed)"]) || parseFloat(r["Cash ($)"]) || 0;
    byDate[label].calls += parseFloat(r["Calls Booked"]) || 0;
    byDate[label].closes += parseFloat(r["Closes"]) || 0;
    byDate[label].shows += parseFloat(r["Shows"]) || 0;
    byDate[label].outbounds += parseFloat(r["Outbound Messages Sent"]) || parseFloat(r["Outbounds"]) || 0;
    byDate[label].convos += parseFloat(r["Total Conversations Had"]) || parseFloat(r["Conversations"]) || 0;
  });
  const chart = Object.values(byDate);
  const prev = { cash: 0, calls: 0, closes: 0, shows: 0, outbounds: 0, convos: 0, followups: 0, hours: 0, pitched: 0, inbounds: 0, qualified: 0, closeRate: "0.0", showRate: "0.0", aov: 0, callToBook: "0.0" };
  return { chart, totals, prev };
}

function calcDelta(curr,prev){if(!prev||prev===0)return null;const pct=((curr-prev)/prev)*100;return{pct:Math.abs(pct).toFixed(1),up:pct>=0};}
function calcRateDelta(curr,prev){const d=parseFloat(curr)-parseFloat(prev);if(Math.abs(d)<0.1)return null;return{pct:Math.abs(d).toFixed(1),up:d>=0,isRate:true};}

function DeltaBadge({delta}){if(!delta)return null;return(<span style={{fontSize:10,fontWeight:700,color:delta.up?GREEN:RED,background:delta.up?"rgba(34,211,165,0.1)":"rgba(244,63,94,0.1)",borderRadius:4,padding:"2px 6px",display:"inline-flex",alignItems:"center",gap:2}} title="vs previous period">{delta.up?"▲":"▼"} {delta.pct}{delta.isRate?"pp":"%"}</span>);}

const CustomTooltip=({active,payload,label})=>{if(!active||!payload?.length)return null;return(<div style={{background:"#0a0a0a",border:"1px solid "+BORDER2,borderRadius:10,padding:"12px 16px",boxShadow:"0 8px 32px rgba(0,0,0,0.8)"}}><div style={{color:LABEL,fontSize:10,fontWeight:700,textTransform:"uppercase",letterSpacing:0.8,marginBottom:10}}>{label}</div>{payload.map((p,i)=>(<div key={i} style={{display:"flex",alignItems:"center",gap:8,marginBottom:i<payload.length-1?7:0}}><div style={{width:7,height:7,borderRadius:"50%",background:p.color,flexShrink:0}}/><span style={{color:MED,fontSize:11}}>{p.name}</span><span style={{color:WHITE,fontSize:13,fontWeight:700,marginLeft:"auto",paddingLeft:24}}>{p.name==="Cash"?fmt$(p.value):fmtN(p.value)}</span></div>))}</div>);};

function MetricCard({title,value,sub,delta}){const[hovered,setHovered]=useState(false);return(<div onMouseEnter={()=>setHovered(true)} onMouseLeave={()=>setHovered(false)} style={{background:CARD,borderRadius:14,padding:"20px 22px",flex:1,minWidth:148,border:"1px solid "+(hovered?BORDER2:BORDER)+"",position:"relative",overflow:"hidden",cursor:"default",transition:"all 0.2s cubic-bezier(0.34,1.56,0.64,1)",transform:hovered?"translateY(-4px) scale(1.02)":"translateY(0) scale(1)",boxShadow:hovered?"0 16px 40px rgba(0,0,0,0.7)":"none"}}>{hovered&&<div style={{position:"absolute",top:0,left:0,right:0,height:2,background:"linear-gradient(90deg,#F97316,#FBBF24)"}}/>}<div style={{fontSize:10,color:LABEL,fontWeight:600,textTransform:"uppercase",letterSpacing:1.2,marginBottom:10}}>{title}</div><div style={{fontSize:30,fontWeight:800,color:WHITE,letterSpacing:-1,marginBottom:8,lineHeight:1}}>{value}</div><div style={{display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:4}}>{sub&&<div style={{fontSize:11,color:SUB,lineHeight:1.4}}>{sub}</div>}<DeltaBadge delta={delta}/></div></div>);}

function SectionLabel({children}){return(<div style={{display:"flex",alignItems:"center",gap:10,marginBottom:10,marginTop:6}}><div style={{fontSize:9,color:SUB,fontWeight:700,textTransform:"uppercase",letterSpacing:2}}>{children}</div><div style={{flex:1,height:1,background:BORDER}}/></div>);}

function GoalCard({current,goal,delta,onEdit,isEditable,monthLabel}){const[editing,setEditing]=useState(false);const[input,setInput]=useState(String(goal));const pct=Math.min((current/goal)*100,100);const daysInMonth=new Date(TODAY.getFullYear(),TODAY.getMonth()+1,0).getDate();const currentDay=TODAY.getDate();const projected=Math.round((current/currentDay)*daysInMonth);const onTrack=projected>=goal;const handleSave=()=>{const val=parseInt(input.replace(/[^0-9]/g,""));if(val>0)onEdit(val);setEditing(false);};return(<div style={{background:CARD,borderRadius:14,padding:"24px 26px",border:"1px solid "+BORDER,marginBottom:16,position:"relative",overflow:"hidden"}}><div style={{position:"absolute",top:0,left:0,right:0,height:2,background:"linear-gradient(90deg,#F97316,#FBBF24,#22D3A5)",opacity:0.6}}/><div style={{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:20}}><div><div style={{display:"flex",alignItems:"center",gap:8,marginBottom:10}}><div style={{fontSize:10,color:LABEL,fontWeight:600,textTransform:"uppercase",letterSpacing:1.2}}>{monthLabel} Target</div>{isEditable&&!editing&&(<button onClick={()=>{setInput(String(goal));setEditing(true);}} style={{background:"none",border:"1px solid "+BORDER2,color:SUB,borderRadius:5,padding:"2px 8px",fontSize:9,cursor:"pointer",fontWeight:600,textTransform:"uppercase",letterSpacing:0.8}}>Edit</button>)}</div>{editing?(<div style={{display:"flex",alignItems:"center",gap:8}}><span style={{fontSize:20,color:SUB,fontWeight:700}}>$</span><input autoFocus type="number" value={input} onChange={e=>setInput(e.target.value)} onKeyDown={e=>{if(e.key==="Enter")handleSave();if(e.key==="Escape")setEditing(false);}} style={{background:"#111",border:"1px solid "+ACCENT,borderRadius:8,padding:"6px 12px",color:WHITE,fontSize:24,fontWeight:800,width:160,outline:"none"}}/><button onClick={handleSave} style={{background:ACCENT,border:"none",borderRadius:8,padding:"7px 14px",color:"#000",fontSize:11,fontWeight:800,cursor:"pointer"}}>Save</button><button onClick={()=>setEditing(false)} style={{background:"none",border:"1px solid "+BORDER2,borderRadius:8,padding:"7px 12px",color:SUB,fontSize:11,cursor:"pointer"}}>Cancel</button></div>):(<div style={{display:"flex",alignItems:"baseline",gap:10,flexWrap:"wrap"}}><span style={{fontSize:38,fontWeight:800,color:WHITE,letterSpacing:-2,lineHeight:1}}>{fmt$(current)}</span><span style={{fontSize:15,color:SUB}}>/ {fmt$(goal)}</span>{delta&&<DeltaBadge delta={delta}/>}</div>)}</div>{!editing&&(<div style={{textAlign:"right"}}><div style={{fontSize:34,fontWeight:800,background:"linear-gradient(135deg,#F97316,#FBBF24)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",letterSpacing:-1,lineHeight:1}}>{pct.toFixed(0)}%</div><div style={{fontSize:10,color:SUB,textTransform:"uppercase",letterSpacing:1,marginTop:4}}>of target</div></div>)}</div><div style={{background:"#111",borderRadius:99,height:5,overflow:"hidden",marginBottom:12}}><div style={{height:"100%",width:pct+"%",background:pct>=100?GREEN:"linear-gradient(90deg,#F97316,#FBBF24)",borderRadius:99,transition:"width 0.6s cubic-bezier(0.4,0,0.2,1)",boxShadow:"0 0 8px rgba(249,115,22,0.4)"}}/></div><div style={{display:"flex",justifyContent:"space-between"}}><span style={{fontSize:12,color:SUB}}><span style={{color:MED,fontWeight:600}}>{fmt$(goal-current)}</span> remaining</span><span style={{fontSize:12,color:SUB}}>Projected: <span style={{color:onTrack?GREEN:ACCENT,fontWeight:700}}>{fmt$(projected)}</span></span></div></div>);}

function MiniCal({viewDate,setViewDate,startDate,endDate,hover,setHover,onSelect}){const yr=viewDate.getFullYear(),mo=viewDate.getMonth();const rawFirst=new Date(yr,mo,1).getDay();const first=(rawFirst+6)%7;const total=new Date(yr,mo+1,0).getDate();const canGoNext=addMonths(viewDate,1)<=TODAY;const cells=[...Array(first).fill(null),...Array.from({length:total},(_,i)=>new Date(yr,mo,i+1))];return(<div style={{width:224}}><div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12}}><button onClick={()=>setViewDate(addMonths(viewDate,-1))} style={{background:BORDER,border:"none",color:MED,cursor:"pointer",fontSize:14,padding:"4px 9px",borderRadius:6,lineHeight:1}}>‹</button><span style={{fontSize:12,color:WHITE,fontWeight:700,letterSpacing:0.2}}>{MONTH_NAMES[mo]} {yr}</span><button onClick={()=>canGoNext&&setViewDate(addMonths(viewDate,1))} style={{background:canGoNext?BORDER:"transparent",border:"none",color:canGoNext?MED:DIM,cursor:canGoNext?"pointer":"default",fontSize:14,padding:"4px 9px",borderRadius:6,lineHeight:1}}>›</button></div><div style={{display:"grid",gridTemplateColumns:"repeat(7,1fr)",marginBottom:6}}>{["Mo","Tu","We","Th","Fr","Sa","Su"].map((d,i)=>(<div key={i} style={{textAlign:"center",fontSize:9,color:SUB,fontWeight:700,letterSpacing:0.5}}>{d}</div>))}</div><div style={{display:"grid",gridTemplateColumns:"repeat(7,1fr)",gap:"3px 0"}}>{cells.map((d,i)=>{if(!d)return <div key={i}/>;const future=d>TODAY;const isSt=sameDay(d,startDate),isEn=sameDay(d,endDate);const eff=endDate||hover;const inRange=startDate&&eff&&d>(startDate<eff?startDate:eff)&&d<(startDate<eff?eff:startDate);const sel=isSt||isEn;const isToday=sameDay(d,TODAY);return(<button key={i} onClick={()=>!future&&onSelect(d)} onMouseEnter={()=>!future&&setHover(d)} style={{background:sel?WHITE:inRange?BORDER2:"none",color:sel?"#000":future?DIM:inRange?MED:isToday?ACCENT:MED,border:"none",borderRadius:6,padding:"6px 0",fontSize:11,cursor:future?"default":"pointer",textAlign:"center",fontWeight:sel?800:isToday?700:400,transition:"background 0.1s"}}>{d.getDate()}</button>);})}</div></div>);}

function DateRangePicker({startDate,endDate,onChange,onClose}){const[selecting,setSelecting]=useState("start");const[hover,setHover]=useState(null);const[viewDate,setViewDate]=useState(new Date(TODAY.getFullYear(),TODAY.getMonth(),1));const handleSelect=d=>{if(selecting==="start"){onChange({start:d,end:null});setSelecting("end");}else{const s=startDate;onChange(s<=d?{start:s,end:d}:{start:d,end:s});setSelecting("start");onClose();}};const topPresets=["Today","This Week","This Month"];const botPresets=["Last 7D","Last 30D","Last 90D"];const allPresets=[...topPresets,...botPresets];const activePreset=allPresets.find(p=>{const r=getPreset(p);if(!r||!startDate||!endDate)return false;return sameDay(r.start,startDate)&&sameDay(r.end,endDate);});return(<div style={{display:"flex",padding:"16px 18px 18px",gap:18}}><div style={{display:"flex",flexDirection:"column",gap:3,minWidth:110}}><div style={{fontSize:9,color:DIM,fontWeight:700,textTransform:"uppercase",letterSpacing:1.5,marginBottom:6,paddingLeft:2}}>Select Date</div>{topPresets.map(p=>{const active=activePreset===p;return(<button key={p} onClick={()=>{onChange(getPreset(p));onClose();}} style={{background:active?BORDER2:"none",border:active?"1px solid "+BORDER2:"1px solid transparent",color:active?WHITE:MED,borderRadius:8,padding:"7px 12px",fontSize:11,fontWeight:active?700:400,cursor:"pointer",textAlign:"left",transition:"all 0.12s",whiteSpace:"nowrap"}}>{p}</button>);})}<div style={{height:1,background:BORDER,margin:"4px 0"}}/>{botPresets.map(p=>{const active=activePreset===p;return(<button key={p} onClick={()=>{onChange(getPreset(p));onClose();}} style={{background:active?BORDER2:"none",border:active?"1px solid "+BORDER2:"1px solid transparent",color:active?WHITE:SUB,borderRadius:8,padding:"6px 12px",fontSize:11,fontWeight:active?700:400,cursor:"pointer",textAlign:"left",transition:"all 0.12s",whiteSpace:"nowrap"}}>{p}</button>);})}</div><div style={{width:1,background:BORDER,flexShrink:0}}/><div onMouseLeave={()=>setHover(null)}><MiniCal viewDate={viewDate} setViewDate={setViewDate} startDate={startDate} endDate={endDate} hover={hover} setHover={setHover} onSelect={handleSelect}/></div></div>);}

function Dashboard({client}){
  const[page,setPage]=useState("overview");
  const[pickerOpen,setPickerOpen]=useState(false);
  const[startDate,setStartDate]=useState(new Date(TODAY.getFullYear(),TODAY.getMonth(),1));
  const[endDate,setEndDate]=useState(TODAY);
  const[targets,setTargets]=useState({});
  const[clientName,setClientName]=useState(client.name);
  const[editingClient,setEditingClient]=useState(false);
  const[clientInput,setClientInput]=useState("");
  const[csvData,setCsvData]=useState(null);
  const[loading,setLoading]=useState(true);
  const pickerRef=useRef();
  const rangeLabel=getRangeLabel(startDate,endDate);

  useEffect(()=>{
    const fetchCSV=()=>{
      Papa.parse(client.csvUrl,{download:true,header:true,skipEmptyLines:true,complete:r=>{setCsvData(r.data);setLoading(false);},error:()=>setLoading(false)});
    };
    fetchCSV();
    const iv=setInterval(()=>window.location.reload(),60*60*1000);
    return()=>clearInterval(iv);
  },[]);

  useEffect(()=>{
    try{const t=localStorage.getItem("targets-"+client.slug);if(t)setTargets(JSON.parse(t));}catch(e){}
    try{const cn=localStorage.getItem("clientname-"+client.slug);if(cn)setClientName(cn);}catch(e){}
  },[]);

  const viewMonth=startDate||TODAY;
  const key=monthKey(viewMonth);
  const activeGoal=targets[key]||client.monthlyTarget;
  const editable=isCurrentMonth(viewMonth);
  const mLabel=MONTH_NAMES[viewMonth.getMonth()];

  const handleEditTarget=val=>{
    const updated={...targets,[key]:val};
    setTargets(updated);
    try{localStorage.setItem("targets-"+client.slug,JSON.stringify(updated));}catch(e){}
  };

  useEffect(()=>{
    const h=e=>{if(pickerRef.current&&!pickerRef.current.contains(e.target))setPickerOpen(false);};
    document.addEventListener("mousedown",h);
    return()=>document.removeEventListener("mousedown",h);
  },[]);

  const {chart,totals:t,prev} = useMemo(()=>{
    if(csvData&&csvData.length>0) return parseCSV(csvData);
    return {chart:[],totals:{cash:0,calls:0,closes:0,shows:0,outbounds:0,convos:0,followups:0,hours:0,pitched:0,inbounds:0,qualified:0,closeRate:"0.0",showRate:"0.0",aov:0,callToBook:"0.0"},prev:{cash:0,calls:0,closes:0,shows:0,outbounds:0,convos:0,followups:0,hours:0,pitched:0,inbounds:0,qualified:0,closeRate:"0.0",showRate:"0.0",aov:0,callToBook:"0.0"}};
  },[csvData]);

  const tick={fill:SUB,fontSize:10};
  const grid={stroke:"#111",strokeDasharray:"3 3"};

  if(loading)return(<div style={{background:BG,minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",fontFamily:"-apple-system,sans-serif"}}><div style={{color:DIM,fontSize:12}}>Loading dashboard...</div></div>);

  return(
    <div style={{background:BG,minHeight:"100vh",fontFamily:"-apple-system,'Inter',sans-serif",color:WHITE,padding:"26px 30px"}}>
      <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:22}}>
        <div>
          <div style={{fontSize:21,fontWeight:800,letterSpacing:-0.8}}>Sales Dashboard</div>
          <div style={{fontSize:10,color:SUB,letterSpacing:2.5,textTransform:"uppercase",marginTop:5,fontWeight:600,display:"flex",alignItems:"center",gap:4}}>
            <span>ML Consulting ×</span>
            {editingClient?(<input autoFocus value={clientInput} onChange={e=>setClientInput(e.target.value)} onKeyDown={e=>{if(e.key==="Enter"){setClientName(clientInput);try{localStorage.setItem("clientname-"+client.slug,clientInput);}catch(ex){}setEditingClient(false);}if(e.key==="Escape")setEditingClient(false);}} onBlur={()=>{setClientName(clientInput);try{localStorage.setItem("clientname-"+client.slug,clientInput);}catch(ex){}setEditingClient(false);}} style={{background:"none",border:"none",borderBottom:"1px solid "+BORDER2,color:SUB,fontSize:10,letterSpacing:2.5,textTransform:"uppercase",fontWeight:600,outline:"none",width:120}}/>):(<span onClick={()=>{setClientInput(clientName);setEditingClient(true);}} style={{cursor:"text",borderBottom:"1px solid transparent"}}>{clientName}</span>)}
          </div>
        </div>
        <div style={{position:"relative"}} ref={pickerRef}>
          <button onClick={()=>setPickerOpen(o=>!o)} style={{display:"flex",alignItems:"center",gap:8,background:pickerOpen?"#111":CARD,border:"1px solid "+(pickerOpen?BORDER2:BORDER)+"",borderRadius:10,padding:"8px 14px",cursor:"pointer",color:WHITE,fontSize:12,fontWeight:500,transition:"all 0.15s"}}>
            <svg width="12" height="12" viewBox="0 0 16 16" fill="none"><rect x="1.5" y="3.5" width="13" height="11" rx="2" stroke="#444" strokeWidth="1.4"/><path d="M5 1.5v3M11 1.5v3M1.5 7.5h13" stroke="#444" strokeWidth="1.4" strokeLinecap="round"/></svg>
            <span style={{maxWidth:200,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}}>{(()=>{const ps=["Today","This Week","This Month","Last 7D","Last 30D","Last 90D"];const m=ps.find(p=>{const r=getPreset(p);return r&&startDate&&endDate&&sameDay(r.start,startDate)&&sameDay(r.end,endDate);});return m||rangeLabel;})()}</span>
            <svg width="9" height="9" viewBox="0 0 10 10" fill="none" style={{transform:pickerOpen?"rotate(180deg)":"none",transition:"0.2s",flexShrink:0}}><path d="M2 3.5L5 6.5L8 3.5" stroke="#444" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round"/></svg>
          </button>
          {pickerOpen&&(<div style={{position:"absolute",top:"calc(100% + 10px)",right:0,zIndex:200,background:CARD,border:"1px solid "+BORDER2,borderRadius:16,boxShadow:"0 20px 60px rgba(0,0,0,0.8)",minWidth:470}}><DateRangePicker startDate={startDate} endDate={endDate} onChange={({start,end})=>{setStartDate(start);setEndDate(end||null);}} onClose={()=>setPickerOpen(false)}/></div>)}
        </div>
      </div>

      <div style={{display:"flex",borderBottom:"1px solid "+BORDER,marginBottom:20,gap:2}}>
        {[["overview","Overview"],["activity","Activity"]].map(([key,name])=>(<button key={key} onClick={()=>setPage(key)} style={{background:"none",border:"none",cursor:"pointer",fontSize:11,fontWeight:700,color:page===key?WHITE:LABEL,padding:"9px 18px",borderBottom:page===key?"2px solid "+(WHITE)+"":"2px solid transparent",marginBottom:-1,transition:"all 0.15s",textTransform:"uppercase",letterSpacing:1.5}}>{name}</button>))}
      </div>

      {page==="overview"&&(<>
        <GoalCard current={t.cash||0} goal={activeGoal} delta={calcDelta(t.cash,prev.cash)} onEdit={handleEditTarget} isEditable={editable} monthLabel={mLabel}/>
        <div style={{display:"flex",gap:10,marginBottom:16,flexWrap:"wrap"}}>
          <MetricCard title="Calls Booked (Qualified)" value={fmtN(t.qualified||0)} sub="Qualified calls booked" delta={calcDelta(t.qualified,prev.qualified)}/>
          <MetricCard title="Show Rate" value={(t.showRate||0)+"%"} sub={(t.shows||0)+" of "+(t.calls||0)+" showed up"} delta={calcRateDelta(t.showRate,prev.showRate)}/>
          <MetricCard title="Close Rate" value={(t.closeRate||0)+"%"} sub={(t.closes||0)+" of "+(t.shows||0)+" calls closed"} delta={calcRateDelta(t.closeRate,prev.closeRate)}/>
          <MetricCard title="Avg Order Value" value={fmt$(t.aov||0)} delta={calcDelta(t.aov,prev.aov)}/>
        </div>
        <div style={{background:CARD,borderRadius:14,padding:"20px 22px",border:"1px solid "+BORDER}}>
          <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16}}>
            <div style={{fontSize:10,color:LABEL,fontWeight:700,textTransform:"uppercase",letterSpacing:1.2}}>Performance Overview</div>
            <div style={{display:"flex",gap:16}}>{[["Cash","#F97316"],["Calls",MED],["Closes",SUB]].map(([n,c])=>(<div key={n} style={{display:"flex",alignItems:"center",gap:5}}><div style={{width:14,height:2,background:c,borderRadius:99}}/><span style={{fontSize:10,color:LABEL}}>{n}</span></div>))}</div>
          </div>
          <ResponsiveContainer width="100%" height={190}>
            <LineChart data={chart}>
              <CartesianGrid stroke="#111" strokeDasharray="3 3"/>
              <XAxis dataKey="label" tick={tick} axisLine={false} tickLine={false}/>
              <YAxis yAxisId="cash" tickFormatter={fmt$} tick={tick} axisLine={false} tickLine={false}/>
              <YAxis yAxisId="count" orientation="right" tick={tick} axisLine={false} tickLine={false}/>
              <Tooltip content={<CustomTooltip/>} cursor={{stroke:BORDER2,strokeWidth:1}}/>
              <Line yAxisId="cash" type="monotone" dataKey="cash" name="Cash" stroke="#F97316" strokeWidth={2} dot={false}/>
              <Line yAxisId="count" type="monotone" dataKey="calls" name="Calls" stroke={MED} strokeWidth={1.5} dot={false}/>
              <Line yAxisId="count" type="monotone" dataKey="closes" name="Closes" stroke={SUB} strokeWidth={1.5} dot={false}/>
            </LineChart>
          </ResponsiveContainer>
        </div>
      </>)}

      {page==="activity"&&(<>
        <SectionLabel>Outreach</SectionLabel>
        <div style={{display:"flex",gap:10,marginBottom:20,flexWrap:"wrap"}}>
          <MetricCard title="Outbounds" value={fmtN(t.outbounds||0)} sub="Total outbound messages" delta={calcDelta(t.outbounds,prev.outbounds)}/>
          <MetricCard title="Follow-Ups" value={fmtN(t.followups||0)} sub="Total follow-ups sent" delta={calcDelta(t.followups,prev.followups)}/>
          <MetricCard title="Conversations" value={fmtN(t.convos||0)} sub="Active conversations" delta={calcDelta(t.convos,prev.convos)}/>
        </div>
        <SectionLabel>Calls</SectionLabel>
        <div style={{display:"flex",gap:10,marginBottom:20,flexWrap:"wrap"}}>
          <MetricCard title="Calls Pitched" value={fmtN(t.pitched||0)} sub="Total calls proposed" delta={calcDelta(t.pitched,prev.pitched)}/>
          <MetricCard title="Calls Booked" value={fmtN(t.calls||0)} sub="Total calls booked" delta={calcDelta(t.calls,prev.calls)}/>
          <MetricCard title="Calls Booked (Qualified)" value={fmtN(t.qualified||0)} sub="Total qualified calls booked" delta={calcDelta(t.qualified,prev.qualified)}/>
        </div>
        <SectionLabel>Other</SectionLabel>
        <div style={{display:"flex",gap:10,marginBottom:20,flexWrap:"wrap"}}>
          <MetricCard title="Inbounds Received" value={fmtN(t.inbounds||0)} sub="Inbound leads received" delta={calcDelta(t.inbounds,prev.inbounds)}/>
          <MetricCard title="Convo to Book Rate" value={(t.callToBook||0)+"%"} sub={(t.calls||0)+" of "+(t.convos||0)+" convos"} delta={calcRateDelta(t.callToBook,prev.callToBook)}/>
          <MetricCard title="Hours Worked" value={(t.hours||0)+"h"} delta={calcDelta(t.hours,prev.hours)}/>
        </div>
        <div style={{background:CARD,borderRadius:14,padding:"20px 22px",border:"1px solid "+BORDER}}>
          <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16}}>
            <div style={{fontSize:10,color:LABEL,fontWeight:700,textTransform:"uppercase",letterSpacing:1.2}}>Activity Breakdown</div>
            <div style={{display:"flex",gap:16}}>{[["Outbounds",WHITE],["Convos",MED],["Booked",SUB]].map(([n,c])=>(<div key={n} style={{display:"flex",alignItems:"center",gap:5}}><div style={{width:14,height:2,background:c,borderRadius:99}}/><span style={{fontSize:10,color:LABEL}}>{n}</span></div>))}</div>
          </div>
          <ResponsiveContainer width="100%" height={190}>
            <LineChart data={chart}>
              <CartesianGrid stroke="#111" strokeDasharray="3 3"/>
              <XAxis dataKey="label" tick={tick} axisLine={false} tickLine={false}/>
              <YAxis tick={tick} axisLine={false} tickLine={false}/>
              <Tooltip content={<CustomTooltip/>} cursor={{stroke:BORDER2,strokeWidth:1}}/>
              <Line type="monotone" dataKey="outbounds" name="Outbounds" stroke={WHITE} strokeWidth={2} dot={false}/>
              <Line type="monotone" dataKey="convos" name="Convos" stroke={MED} strokeWidth={1.5} dot={false}/>
              <Line type="monotone" dataKey="calls" name="Booked" stroke={SUB} strokeWidth={1.5} dot={false}/>
            </LineChart>
          </ResponsiveContainer>
        </div>
      </>)}
    </div>
  );
}

function App(){
  const[client,setClient]=useState(null);
  const[notFound,setNotFound]=useState(false);
  useEffect(()=>{
    const path=window.location.pathname.replace("/","").toLowerCase()||"client";
    const found=CLIENTS.find(c=>c.slug.toLowerCase()===path);
    if(found)setClient(found);else setNotFound(true);
  },[]);
  if(notFound)return(<div style={{background:BG,minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",fontFamily:"-apple-system,sans-serif",color:WHITE}}><div style={{textAlign:"center"}}><div style={{fontSize:48,marginBottom:16,color:DIM}}>404</div><div style={{color:SUB,fontSize:14}}>Client not found</div></div></div>);
  if(!client)return(<div style={{background:BG,minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"}}><div style={{color:DIM,fontSize:12,fontFamily:"-apple-system,sans-serif"}}>Loading...</div></div>);
  return <Dashboard client={client}/>;
}

ReactDOM.createRoot(document.getElementById("root")).render(<App/>);
</script>
</body>
</html>
